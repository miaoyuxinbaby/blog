---
title: 10月杂记
date: 2019-11-05 20:08:21
categories: 少女日记
---

我的 10 月猪生活

<!--more-->

## 国庆

待在家里 11 天。

生活是这样的：

```火星文
1h网络聊天，
8h睡觉，
2h游戏，
3h动漫，
3h看书，
2h网上冲浪，
3h听妈妈叨叨。 (蝉在叫，人坏掉)
2h吃喝拉撒。
```

_如果妈妈不叨叨，那真是太好了。_

## coding

在项目里开始所有代码都用 `TypeScript` 来编写，这得益于 9.15-10.7 这段时间每天花一点时间去学习，阅读文档，并感谢 github。

从一开始的很慌，万一又哪里卡壳了，怎么办。到现在的镇定自若，哦，这个错啊，这样改就行了。

在无聊的业务搬砖中，算是找到了可以提起点兴致的事情。

写着写着发现，ts 的代码提示确实比 js 强，用上后我觉得生活更美好了。

## 最近遇到了几个值得记录的问题。

### antd-mobile 的 `PullToRefresh` 组件 上拉刷新 问题

在 Android 的 webview 中，scrollTop 数值是小数，ios 和浏览器中都是整数。这导致 antd 内的 `===` 代码未执行。所以无法拉动刷新。

issue 中有类似的 bug 报告，但过去了数月，依旧没有人跟进。我今天也是第一次感觉到生态的重要性

### 关于 ts 中 window 对象上挂在属性的问题。

我使用的脚手架 `create-react-app`，中默认设置了 `react-app-env.d.ts` 可以在其中 `declare` module。

但其并没有在 `tsconfig.json` 的 `include` 选项中输入路径，需要自己将路径写进去，才可以成功 declare，这很奇怪。。

### jsBridge 互相调用

ios 的 webview，如果在页面渲染完毕立即读取 app 注入的方法，有一定几率获取值为 undefined。这时候可以用一个 延时器，200ms 后再去读取

js 调用 app 方法，app 可以直接 return 值，js 可以拿到。

如果调用 app 方法后，需要和 app 进行一段复杂交互，可以约定好，告诉 app 在完成后调用指定 js 方法。比如 `jsTaskStack`。 每次 js 调用 app 方法的时候，可以重新挂载一个接下来可能会执行的方法，覆盖原 window.jsTaskStack。

### 关于主观能动性

我真是太懒了，只要 github 能找到代码，我绝对不自己写。

比如最近用到的，lazy-load, backTop 之类的小组件。
